analysis1 <- fit_bds(phy, sampling_fraction, num_classes = num_classes, condition_survival = FALSE, condition_marginal_survival = FALSE, condition_root_speciation = TRUE, extinction_approximation = FALSE, verbose = T)
## condition on mrca and per-category survival
analysis2 <- fit_bds(phy, sampling_fraction, num_classes = num_classes, condition_survival = FALSE, condition_marginal_survival = TRUE, condition_root_speciation = TRUE, extinction_approximation = TRUE, verbose = T)


lnls = [ -4049.270, -4038.693, -4037.760, -4037.618, -4037.809, -4038.184, -4038.674, -4039.244, -4039.872, -4040.542, -4041.246, -4041.976, -4042.726, -4043.494,
   -4044.275, -4045.067, -4045.869, -4046.679, -4047.495, -4048.317, -4049.143, -4049.972, -4050.805, -4051.640, -4052.476, -4053.315, -4054.154, -4054.994,
   -4055.834, -4056.675, -4057.516, -4058.356, -4059.196, -4060.035, -4060.874, -4061.712, -4062.548, -4063.384, -4064.218, -4065.051, -4065.883, -4066.714,
   -4067.542, -4068.370, -4069.195, -4070.019, -4070.842, -4071.662, -4072.481, -4073.298, -4074.113, -4074.927, -4075.738, -4076.547, -4077.355, -4078.160,
   -4078.964, -4079.765, -4080.565, -4081.362, -4082.157, -4082.951, -4083.742, -4084.531, -4085.318, -4086.103, -4086.886, -4087.667, -4088.445, -4089.222,
   -4089.996, -4090.768, -4091.538, -4092.306, -4093.071, -4093.835, -4094.596, -4095.355, -4096.112, -4096.867, -4097.620, -4098.370, -4099.119, -4099.865,
   -4100.609, -4101.350, -4102.090, -4102.827, -4103.562, -4104.295, -4105.026, -4105.755, -4106.481, -4107.205, -4107.927, -4108.647, -4109.365, -4110.080,
   -4110.793, -4111.504, -4112.213 ]


p1 = plot(xlabel = "shift rate (eta)", ylabel = "log likelihood", title = "constant extinction, 5 spec. rate categories")

plot!(p1, shift_rates, lnls1, label = "allowed", color = :black)
scatter!(p1, shift_rates, lnls1, label = "", color = :black)


plot!(p1, shift_rates, lnls2, label = "disallowed", color = :orange)
scatter!(p1, shift_rates, lnls2, label = "", color = :orange)

p1



p2 = plot(xlabel = "shift rate (eta)", ylabel = "log likelihood", title = "5 sp and 5 mu (25 cats)")

plot!(p2, shift_rates, lnls1, label = "allowed", color = :black)
scatter!(p2, shift_rates, lnls1, label = "", color = :black)


plot!(p2, shift_rates, lnls2, label = "disallowed", color = :orange)
scatter!(p2, shift_rates, lnls2, label = "", color = :orange)

p2



## RevBayes vs RPesto

nan = NaN

shift_rates = [	0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10	] / 1000
   -4213.7597
lnls1_revbayes = [	-4.05088e+06,-4.01947e+06,-4.01722e+06,-4.01649e+06,-4.01643e+06,-4.01675e+06,-4.01731e+06,-4.01804e+06,-4.0189e+06,-4.01985e+06,-4.02087e+06,-4.02195e+06,-4.02309e+06,-4.02426e+06,-4.02547e+06,-4.0267e+06,-4.02796e+06,-4.02924e+06,-4.03054e+06,-4.03185e+06,-4.03318e+06,-4.03452e+06,-4.03587e+06,-4.03723e+06,-4.0386e+06,-4.03998e+06,-4.04136e+06,-4.04275e+06,-4.04414e+06,-4.04554e+06,-4.04694e+06,-4.04835e+06,-4.04975e+06,-4.05116e+06,-4.05257e+06,-4.05399e+06,-4.0554e+06,-4.05682e+06,-4.05823e+06,-4.05965e+06,-4.06107e+06	] / 1000
lnls2_revbayes = [	-4.05088e+06,-4.01919e+06,-4.01678e+06,-4.01591e+06,-4.0157e+06,-4.01587e+06,-4.01629e+06,-4.01688e+06,-4.0176e+06,-4.01842e+06,-4.01931e+06,-4.02027e+06,-4.02127e+06,-4.02231e+06,-4.0234e+06,-4.0245e+06,-4.02564e+06,-4.0268e+06,-4.02797e+06,-4.02916e+06,-4.03036e+06,-4.03157e+06,-4.03279e+06,-4.03402e+06,-4.03526e+06,-4.0365e+06,-4.03774e+06,-4.03899e+06,-4.04023e+06,-4.04148e+06,-4.04273e+06,-4.04398e+06,-4.04522e+06,-4.04646e+06,-4.0477e+06,-4.04894e+06,-4.05017e+06,-4.05139e+06,-4.05261e+06,-4.05383e+06,-4.05503e+06	] / 1000


shift_rates_rpesto = shift_rates / 10

lnls1_rpesto = [-4050.74996946603, -4019.35281338567, -4017.29639451441, -4016.7058789912, 
-4016.76985085792, -4017.20719280135, -4017.88591943492, -4018.73301534392, 
-4019.70401873911, -4020.7697032389, -4021.90963707646, -4023.10966721676, 
-4024.35873683767, -4025.64861344589, -4026.97285180053, -4028.32622477434, 
-4029.70461067155, -4031.1046099028, -4032.52335602197, -4033.95852740957, 
-4035.40809777738, -4036.87044483822, -4038.34383467135, -4039.82722192724, 
-4041.31939888156, -4042.81936913947, -4044.32631505302, -4045.83944220416, 
-4047.35806782184, -4048.88154632833, -4050.40947451965, -4051.9411249071, 
-4053.47610263706, -4055.01400801015, -4056.5545476288, -4058.09732215539, 
-4059.6420191915, -4061.18830630184, -4062.73595405683, -4064.28466317764, 
-4065.83421624082]
lnls2_rpesto = [ -4050.74996946603, -4019.04186790977, -4016.82685877195, -4016.08762688633, 
-4016.0062229182, -4016.30141243825, -4016.8413678186, -4017.55292038272, 
-4018.3915781951, -4019.32798520942, -4020.34168092885, -4021.41791468986, 
-4022.54564657765, -4023.71625952857, -4024.92313001865, -4026.16095725008, 
-4027.42521840624, -4028.71239257082, -4030.01933346988, -4031.34366317041, 
-4032.68288413354, -4034.03497595465, -4035.3985246678, -4036.7719173757, 
-4038.15368906462, -4039.54277118146, -4040.93818371542, -4042.3387760174, 
-4043.74363737973, -4045.15252684796, -4046.56387078564, -4047.9777023007, 
-4049.39313511785, -4050.80957128854, -4052.22654051516, -4053.64339924018, 
-4055.06024981336, -4056.47646643431, -4057.89148348431, -4059.30526077365, 
-4060.7174718419 ]

p3 = plot(xlabel  = "shift rate", ylabel = "log likelihood", title = "shifts allowed on ext. lins")

scatter!(p3, shift_rates, lnls1_revbayes, label = "RevBayes")
scatter!(p3, shift_rates, lnls1_rpesto, label = "RPesto")

p4 = plot(xlabel  = "shift rate", ylabel = "log likelihood", title = "shifts disallowed")

scatter!(p4, shift_rates, lnls2_revbayes, label = "RevBayes")
scatter!(p4, shift_rates, lnls2_rpesto, label = "RPesto")

px = plot(p3, p4, link = :y)



include("times.txt")
include("e.txt")

y = hcat(e...)'

plot(times, y)
















